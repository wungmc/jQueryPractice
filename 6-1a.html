<!DOCTYPE html
PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=GBK" />
<meta http-equiv="Content-Language" content="zh-cn" />

<title>传统的javaScript实现ajax功能</title>
<style type="text/css">
.divFrame {
	border:1px solid #666;
	text-align:center;	
	width:533px;
	font-size:13px;
}
.divFrame .divTitle {
	background-color:#eee;
	padding:5px 0px 5px 0px;
}
.divFrame .divContent {
	padding:5px 0px 5px 0px;
}
.divFrame .divContent img {
	border:1px solid #eee;
	padding:2px;
}
</style>
<script type="text/javascript" src="js/jquery-1.8.3.min.js"></script>
<script language="javascript" type="text/javascript">
function getData() {
	document.getElementById("divContent").innerHTML = 
		"<img src='image/Loading.gif' title='加载中...' />";
		
	var objXmlHttp = null;
	if (window.ActiveXObject) {
		objXmlHttp = new ActiveXObject("Mirosoft.XMLHTTP");
	}
	else {
		if (window.XMLHttpRequest) {
			objXmlHttp = new XMLHttpRequest();
		}
		else {
			alert("初始化XmlHttpRequest错误");
		}
	}
	
	var sendUrlStr = "6-1b.html?date=" + Date();
	//open(method, url, async, username, password)
	objXmlHttp.open("GET", sendUrlStr, true);
	objXmlHttp.onreadystatechange = function() {
		if (objXmlHttp.readyState == 4) {//加载完成
			if (objXmlHttp.status == 200) {
				document.getElementById("divContent").innerHTML = objXmlHttp.responseText;
			}
		}
	}
	objXmlHttp.send(null);
}
</script>

</head>
<body>
	<div class="divFrame">
		<div> 
			<input type="button" onclick="getData();" value="加载数据"/>
		</div>
		<div id="divContent">
			
		</div>
	</div>
</body>
</html>